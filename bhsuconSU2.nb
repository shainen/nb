(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     81986,       2128]
NotebookOptionsPosition[     79095,       2028]
NotebookOutlinePosition[     79452,       2044]
CellTagsIndexPosition[     79409,       2041]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Kernels", "Section",
 CellChangeTimes->{{3.592938561539908*^9, 3.592938588392203*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<SubKernels`RemoteKernels`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.592938018739342*^9, 3.592938021258257*^9}, {
  3.592938284780853*^9, 3.592938306139266*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LaunchKernels", "[", 
  RowBox[{"RemoteMachine", "[", 
   RowBox[{"\"\<node01\>\"", ",", "8"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.592938205658225*^9, 3.592938279735852*^9}, {
  3.592938342993381*^9, 3.592938344840676*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"KernelObject", "[", 
    RowBox[{"17", ",", "\<\"node01\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"18", ",", "\<\"node01\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"19", ",", "\<\"node01\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"20", ",", "\<\"node01\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"21", ",", "\<\"node01\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"22", ",", "\<\"node01\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"23", ",", "\<\"node01\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"24", ",", "\<\"node01\"\>"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.592938670035742*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LaunchKernels", "[", 
  RowBox[{"RemoteMachine", "[", 
   RowBox[{"\"\<node02\>\"", ",", "8"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.592938205658225*^9, 3.592938279735852*^9}, {
  3.592938342993381*^9, 3.592938344840676*^9}, {3.592938608463493*^9, 
  3.592938608544231*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"KernelObject", "[", 
    RowBox[{"25", ",", "\<\"node02\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"26", ",", "\<\"node02\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"27", ",", "\<\"node02\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"28", ",", "\<\"node02\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"29", ",", "\<\"node02\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"30", ",", "\<\"node02\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"31", ",", "\<\"node02\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"32", ",", "\<\"node02\"\>"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.592938674292969*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LaunchKernels", "[", 
  RowBox[{"RemoteMachine", "[", 
   RowBox[{"\"\<node03\>\"", ",", "8"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.592938205658225*^9, 3.592938279735852*^9}, {
  3.592938342993381*^9, 3.592938344840676*^9}, {3.592938612990243*^9, 
  3.592938613095679*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"KernelObject", "[", 
    RowBox[{"33", ",", "\<\"node03\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"34", ",", "\<\"node03\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"35", ",", "\<\"node03\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"36", ",", "\<\"node03\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"37", ",", "\<\"node03\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"38", ",", "\<\"node03\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"39", ",", "\<\"node03\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"40", ",", "\<\"node03\"\>"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.592938678558911*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LaunchKernels", "[", 
  RowBox[{"RemoteMachine", "[", 
   RowBox[{"\"\<node04\>\"", ",", "8"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.592938205658225*^9, 3.592938279735852*^9}, {
  3.592938342993381*^9, 3.592938344840676*^9}, {3.592938615979357*^9, 
  3.592938616042189*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"KernelObject", "[", 
    RowBox[{"41", ",", "\<\"node04\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"42", ",", "\<\"node04\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"43", ",", "\<\"node04\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"44", ",", "\<\"node04\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"45", ",", "\<\"node04\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"46", ",", "\<\"node04\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"47", ",", "\<\"node04\"\>"}], "]"}], ",", 
   RowBox[{"KernelObject", "[", 
    RowBox[{"48", ",", "\<\"node04\"\>"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.592938682834594*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Constants", "Section",
 CellChangeTimes->{{3.589215182456731*^9, 3.589215187213883*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "SetDirectory", "[", 
    "\"\</Users/shainen/Dropbox/Research/bhsucon/nb/nb\>\"", "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.592920083817597*^9, 3.592920121646731*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/shainen/Dropbox/Research/bhsucon/nb/nb\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.592920083817597*^9, 3.592920121646731*^9}, {
  3.592999288783333*^9, 3.592999293555592*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<constants.m\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.59284617559564*^9, 3.592846176837407*^9}, {
   3.592846208771492*^9, 3.5928462188477793`*^9}, 3.592846272022893*^9, {
   3.5928463169771442`*^9, 3.5928463503638353`*^9}, {3.5928464073145933`*^9, 
   3.592846408426299*^9}, {3.592846439821597*^9, 3.592846462899673*^9}, {
   3.592846824691866*^9, 3.5928469000185413`*^9}, 3.5928483107236958`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"su2Runs", "=", "1000"}]], "Input",
 CellChangeTimes->{{3.592999128251843*^9, 3.592999133505015*^9}, 
   3.592999345231771*^9}],

Cell[BoxData["1000"], "Output",
 CellChangeTimes->{3.592999134343481*^9, 3.592999300628357*^9, 
  3.592999345745088*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamic Equations", "Section",
 CellChangeTimes->{{3.5885128669698277`*^9, 3.588512875134413*^9}, {
  3.589215235846583*^9, 3.5892152387745934`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"m", ",", "n"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "Sites"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vss", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"m", ",", "n"}], "]"}], "[", "t", "]"}], 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"m", ",", "n"}], "]"}], "[", "t", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "Sites"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"m", ",", "n"}], "]"}], "'"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "Sites"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialss", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"m", ",", "n"}], "]"}], "[", "0", "]"}], "\[Equal]", 
         RowBox[{
          SubscriptBox["s", "0"], "[", 
          RowBox[{"m", ",", "n"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "Sites"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]s", "[", 
    RowBox[{"m_", ",", "ow_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"ow", ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"m", ",", "n"}], "]"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5885118599939547`*^9, 3.588511890801873*^9}, {
   3.5885120245597343`*^9, 3.588512031889647*^9}, {3.588512068688981*^9, 
   3.5885120719992733`*^9}, {3.5885129213531303`*^9, 
   3.5885130304110518`*^9}, {3.588513166000692*^9, 3.588513167989781*^9}, {
   3.588513252958805*^9, 3.588513258666245*^9}, {3.589215275774458*^9, 
   3.589215314105054*^9}, {3.5892802426653347`*^9, 3.589280265774637*^9}, {
   3.5892830440400057`*^9, 3.589283044393158*^9}, {3.589285102557769*^9, 
   3.589285105628028*^9}, {3.589293301397902*^9, 3.589293301536866*^9}, {
   3.589293340393236*^9, 3.589293354472783*^9}, {3.592408804280298*^9, 
   3.592408844344481*^9}, {3.592919859735495*^9, 3.5929198914240026`*^9}, 
   3.5929985884020853`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sw", "[", 
    RowBox[{"m_", ",", "ow_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"[", "m", "]"}], "]"}], " ", " ", "ow"}], "-", 
    RowBox[{
     FractionBox["\[ImaginaryI]", "2"], 
     RowBox[{
      RowBox[{"vs", "[", 
       RowBox[{"[", "m", "]"}], "]"}], " ", "\[Cross]", 
      RowBox[{"\[CapitalDelta]s", "[", 
       RowBox[{"m", ",", "ow"}], "]"}]}]}], "-", 
    RowBox[{
     FractionBox["1", "8"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalDelta]s", "[", 
        RowBox[{"m", ",", "ow"}], "]"}], "+", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], " ", ".", 
          RowBox[{"\[CapitalDelta]s", "[", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"\[CapitalDelta]s", "[", 
              RowBox[{"m", ",", "ow"}], "]"}], "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], "-", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"vs", "[", 
         RowBox[{"[", "m", "]"}], "]"}], " ", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]s", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"\[CapitalDelta]s", "[", 
               RowBox[{"m", ",", "ow"}], "]"}], "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ")"}]}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swb", "[", 
    RowBox[{"m_", ",", "ow_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"[", "m", "]"}], "]"}], " ", " ", "ow"}], "+", 
    RowBox[{
     FractionBox["\[ImaginaryI]", "2"], 
     RowBox[{
      RowBox[{"vs", "[", 
       RowBox[{"[", "m", "]"}], "]"}], " ", "\[Cross]", 
      RowBox[{"\[CapitalDelta]s", "[", 
       RowBox[{"m", ",", "ow"}], "]"}]}]}], "-", 
    RowBox[{
     FractionBox["1", "8"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalDelta]s", "[", 
        RowBox[{"m", ",", "ow"}], "]"}], "+", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vs", "[", 
           RowBox[{"[", "m", "]"}], "]"}], " ", ".", 
          RowBox[{"\[CapitalDelta]s", "[", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"\[CapitalDelta]s", "[", 
              RowBox[{"m", ",", "ow"}], "]"}], "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], "-", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"vs", "[", 
         RowBox[{"[", "m", "]"}], "]"}], " ", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]s", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"\[CapitalDelta]s", "[", 
               RowBox[{"m", ",", "ow"}], "]"}], "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ")"}]}]}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.587201730748658*^9, 3.587201796129904*^9}, {
   3.587201841064736*^9, 3.58720189936836*^9}, {3.587201940717195*^9, 
   3.587202021158637*^9}, 3.587202149097784*^9, {3.587202342462145*^9, 
   3.587202357592731*^9}, {3.587202388059535*^9, 3.587202470824738*^9}, {
   3.5872033378794003`*^9, 3.587203345166335*^9}, {3.5872106470651093`*^9, 
   3.587210660822157*^9}, {3.5872107670942097`*^9, 3.587210777833684*^9}, {
   3.592408908071216*^9, 3.59240894229657*^9}, {3.592408977194459*^9, 
   3.592409166258515*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Hs", "[", 
    RowBox[{"m_", ",", "ow_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["U", "2"], 
     RowBox[{
      RowBox[{"sw", "[", 
       RowBox[{"m", ",", 
        RowBox[{
         RowBox[{"sw", "[", 
          RowBox[{"m", ",", "ow"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "-", 
    RowBox[{"J", " ", "navg", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sw", "[", 
          RowBox[{"m", ",", "ow"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sw", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sw", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"m", "+", "1"}], ",", "Sites"}], "}"}]}], "]"}]}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"sw", "[", 
          RowBox[{"m", ",", "ow"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sw", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sw", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"m", "+", "1"}], ",", "Sites"}], "}"}]}], "]"}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{"\[Mu]", " ", 
     RowBox[{
      RowBox[{"sw", "[", 
       RowBox[{"m", ",", "ow"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hsb", "[", 
    RowBox[{"m_", ",", "ow_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["U", "2"], 
     RowBox[{
      RowBox[{"swb", "[", 
       RowBox[{"m", ",", 
        RowBox[{
         RowBox[{"swb", "[", 
          RowBox[{"m", ",", "ow"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "-", 
    RowBox[{"J", " ", "navg", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"swb", "[", 
          RowBox[{"m", ",", "ow"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"swb", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"swb", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"m", "+", "1"}], ",", "Sites"}], "}"}]}], "]"}]}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"swb", "[", 
          RowBox[{"m", ",", "ow"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"swb", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"swb", "[", 
              RowBox[{"n", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"m", "+", "1"}], ",", "Sites"}], "}"}]}], "]"}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{"\[Mu]", " ", 
     RowBox[{
      RowBox[{"swb", "[", 
       RowBox[{"m", ",", "ow"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxVsoQ3EAB+A1NsVkkqalTG4vHuQSecCJB88exEIoTziEkcvRUlqxIaNc
tkzmErms3DbyQDrGyZaarFCWuRxyeVmI8v+dh68vvrappE4sEomUBO5PZ5/D
HDxV9DcYwPOPTKKMzJcZkvDYQ/GXnJwzXi/sSrOFR5K1js04zCsM+sY9njJl
bA1jusm7gD0JHYvYLbOop8m+DXUV5q1PbTjlm9XgSafLgq/KLbN4yC3vHtzn
KW9Inha7Fdk6fBKzKtzLjubqyTP+C+H7m96l4AOeeu+zLuPQOec23k7NtOOa
38MD4buVY+zVLXN4QvV9jtsLrt8wE2C+8GVp5Y6ETJ8u2vGaMvkF+1qiXvEU
t6uQkmM9LiWml4x3dvJnBOfHKvrlA0ttAeHWuoYf3FzRE+Qgr3eJz8xHPJVv
GrjFhSua6B9ytZlNwSMSrhNnHRkZ/A94Ce0q
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqnss1", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ds", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "n"}], "]"}], "]"}], "\[Equal]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Hs", "[", 
          RowBox[{"1", ",", 
           RowBox[{"vs", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "n"}], "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"Hsb", "[", 
          RowBox[{"1", ",", 
           RowBox[{"vs", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "n"}], "]"}], "]"}]}], "]"}]}], ")"}]}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5892877854682903`*^9, 3.589287822343604*^9}, {
   3.589288015351014*^9, 3.589288015424478*^9}, {3.589288154579464*^9, 
   3.58928815491245*^9}, {3.5892887894639*^9, 3.589288811102025*^9}, 
   3.5892912779548683`*^9, {3.589656659087839*^9, 3.589656671039879*^9}, {
   3.589656770862111*^9, 3.589656786793612*^9}, {3.5897122075326*^9, 
   3.589712212033519*^9}, {3.59222055044774*^9, 3.5922205528074617`*^9}, {
   3.592409435543378*^9, 3.592409470068243*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"\[Mu]", "-", 
        RowBox[{"U", " ", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], "-", 
     
     RowBox[{"J", " ", "navg", " ", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Mu]"}], "+", 
        RowBox[{"U", " ", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], "+", 
     
     RowBox[{"J", " ", "navg", " ", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{"J", " ", "navg", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.592409492354896*^9, 3.59241014323987*^9, 3.592415090054068*^9, {
   3.592847631448155*^9, 3.592847647034206*^9}, 3.592918377420231*^9, 
   3.592918435521859*^9, 3.5929200731625137`*^9, 3.5929201281712837`*^9, 
   3.592999140155933*^9, 3.592999304142804*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqnss", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"eqnss1", "/.", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"1", ",", "n"}], "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"m", ",", "n"}], "]"}], "'"}], "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"1", ",", "n"}], "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"m", ",", "n"}], "]"}], "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"m", ",", "n"}], "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"1", ",", "n"}], "]"}], "[", "t", "]"}]}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "Sites"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.587202999694027*^9, 3.5872030022407637`*^9}, {
   3.5872033850002537`*^9, 3.5872035012748327`*^9}, {3.587210196444747*^9, 
   3.587210205205906*^9}, {3.58721023957014*^9, 3.5872102461618423`*^9}, {
   3.587210545038622*^9, 3.5872105454526577`*^9}, {3.587210608051319*^9, 
   3.587210642353087*^9}, {3.587210687996533*^9, 3.587210688248773*^9}, {
   3.5872107434164867`*^9, 3.5872107585759706`*^9}, {3.587213577280397*^9, 
   3.587213581068581*^9}, {3.58721361271357*^9, 3.587213671452993*^9}, 
   3.587214393536255*^9, {3.588512807732107*^9, 3.588512842660493*^9}, {
   3.588513326908942*^9, 3.588513330941484*^9}, {3.589286127005034*^9, 
   3.589286185545135*^9}, {3.589291311870324*^9, 3.589291491716262*^9}, {
   3.5892915685071287`*^9, 3.5892915943741693`*^9}, {3.5892916482387953`*^9, 
   3.589291684914825*^9}, {3.589291730582954*^9, 3.589291735470666*^9}, {
   3.589660897990499*^9, 3.5896609105486193`*^9}, 3.5897122558704443`*^9, {
   3.592242763639052*^9, 3.5922427996914*^9}, {3.592242833291318*^9, 
   3.5922428881657867`*^9}, {3.59240954763713*^9, 3.592409579714078*^9}, {
   3.59240962724294*^9, 3.592409669799705*^9}, 3.592998593139779*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "eqnss", "]"}]], "Input",
 CellChangeTimes->{{3.589293254157106*^9, 3.589293255646174*^9}, {
   3.589293453259919*^9, 3.589293456738038*^9}, 3.592311451049191*^9, {
   3.592409750415209*^9, 3.5924097532074757`*^9}, {3.592414009929037*^9, 
   3.59241401183033*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Mu]", "-", 
            RowBox[{"U", " ", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], 
         "-", 
         RowBox[{"J", " ", "navg", " ", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}]}], 
           ")"}]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Mu]"}], "+", 
            RowBox[{"U", " ", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"J", " ", "navg", " ", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], 
           ")"}]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"J", " ", "navg", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}]}], ")"}]}]}], 
          ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Mu]", "-", 
            RowBox[{"U", " ", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], 
         "-", 
         RowBox[{"J", " ", "navg", " ", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}]}], 
           ")"}]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Mu]"}], "+", 
            RowBox[{"U", " ", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"J", " ", "navg", " ", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], 
           ")"}]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"J", " ", "navg", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}]}], ")"}]}]}], 
          ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"3", ",", "1"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "J"}], " ", "navg", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}]}], ")"}], " ", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"3", ",", "3"}], "]"}], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Mu]", "-", 
            RowBox[{"U", " ", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"3", ",", "3"}], "]"}], "[", "t", "]"}]}]}], 
           ")"}]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"3", ",", "2"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"J", " ", "navg", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}]}], ")"}], " ", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"3", ",", "3"}], "]"}], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Mu]"}], "+", 
            RowBox[{"U", " ", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"3", ",", "3"}], "]"}], "[", "t", "]"}]}]}], 
           ")"}]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"J", " ", "navg", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], "+", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}]}], ")"}], " ", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], "+", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"2", ",", "1"}], "]"}], "[", "t", "]"}]}], ")"}], " ", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"3", ",", "2"}], "]"}], "[", "t", "]"}]}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.592409753470091*^9, 3.592414012651136*^9, 3.592415090166917*^9, {
   3.592847631509959*^9, 3.592847647113473*^9}, 3.5929183775214453`*^9, 
   3.592918435616147*^9, 3.592920128246915*^9, 3.5929991404162683`*^9, 
   3.592999304257409*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Wigner with neg prob", "Section",
 CellChangeTimes->{{3.591544264266828*^9, 3.591544264904193*^9}, {
   3.592309591171804*^9, 3.592309597728499*^9}, 3.592410271675445*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"svarsingreek", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Beta]", " ", 
         RowBox[{"Conjugate", "[", "\[Alpha]", "]"}]}], "+", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Beta]", " ", 
         RowBox[{"Conjugate", "[", "\[Alpha]", "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "\[Alpha]", " ", 
         RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"Conjugate", "[", "\[Alpha]", "]"}]}], "-", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}]}], ")"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.591545384843833*^9, 3.5915453933370953`*^9}, {
   3.591545484081254*^9, 3.591545517476824*^9}, {3.591545886631249*^9, 
   3.591545914564167*^9}, {3.591546430647994*^9, 3.59154645485389*^9}, {
   3.592410284658484*^9, 3.592410287986812*^9}, 3.592410352532791*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Norm1", "=", 
   FractionBox[
    RowBox[{"4", "-", 
     SqrtBox["\[ExponentialE]"]}], 
    SqrtBox["\[ExponentialE]"]]}], ";"}]], "Input",
 CellChangeTimes->{{3.592411450702297*^9, 3.592411470071447*^9}, {
  3.5924118144649477`*^9, 3.5924118386687098`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Norm2", "=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["1", 
       SqrtBox["2"]]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SqrtBox["2"]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         SqrtBox["2"]}], ")"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        SqrtBox["2"]]}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"1", "+", 
        FractionBox["1", 
         SqrtBox["2"]]}]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.592411450702297*^9, 3.592411470071447*^9}, 
   3.592411798222858*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fock1Mag", "=", 
   RowBox[{"ProbabilityDistribution", "[", 
    RowBox[{
     RowBox[{"4", " ", "a", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], 
        SuperscriptBox["a", "2"]}]], 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           SuperscriptBox["a", "2"]}], "-", "1"}], ")"}], "]"}], "/", 
       "Norm1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.59170454302216*^9, 3.5917045679347343`*^9}, {
  3.591704618731945*^9, 3.591704621368908*^9}, {3.5917055444499683`*^9, 
  3.591705545058207*^9}, {3.5924109662295513`*^9, 3.592411041421261*^9}, {
  3.5924111308499203`*^9, 3.592411136728883*^9}, {3.592411474716214*^9, 
  3.59241147739036*^9}, {3.5924118496167917`*^9, 3.592411870718696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fock2Mag", "=", 
   RowBox[{"ProbabilityDistribution", "[", 
    RowBox[{
     RowBox[{"4", " ", "a", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], 
        SuperscriptBox["a", "2"]}]], 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["a", "2"]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["a", "4"]}]}], ")"}], "]"}], "/", "Norm2"}]}], ",", 
     
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.59170454302216*^9, 3.5917045679347343`*^9}, {
   3.591704618731945*^9, 3.591704621368908*^9}, {3.5917055444499683`*^9, 
   3.591705545058207*^9}, {3.5924109662295513`*^9, 3.592411041421261*^9}, {
   3.5924111308499203`*^9, 3.592411136728883*^9}, {3.592411474716214*^9, 
   3.59241147739036*^9}, 3.59241184692596*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"randmag1", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"Fock1Mag", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "Sites", ",", "su2Runs"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5915418284634933`*^9, 3.591541974153631*^9}, {
   3.591542133188566*^9, 3.59154218548804*^9}, 3.591542497272621*^9, {
   3.591542584598591*^9, 3.591542587253887*^9}, {3.591542635126169*^9, 
   3.5915426404689713`*^9}, {3.591542929763564*^9, 3.59154293633947*^9}, 
   3.5915429741991997`*^9, {3.591704687510915*^9, 3.591704697289447*^9}, {
   3.59170474157908*^9, 3.591704821817129*^9}, {3.59170486674509*^9, 
   3.591704888738887*^9}, 3.591705370444601*^9, 3.591705510131855*^9, {
   3.591707100395672*^9, 3.591707101264482*^9}, {3.592309798356081*^9, 
   3.5923097996986017`*^9}, {3.592411162495311*^9, 3.592411172665133*^9}, {
   3.592411904245418*^9, 3.5924119095926*^9}, 3.592851334474393*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"randmag2", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"Fock2Mag", ",", 
     RowBox[{"{", 
      RowBox[{"Sites", ",", "su2Runs"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5915418284634933`*^9, 3.591541974153631*^9}, {
   3.591542133188566*^9, 3.59154218548804*^9}, 3.591542497272621*^9, {
   3.591542584598591*^9, 3.591542587253887*^9}, {3.591542635126169*^9, 
   3.5915426404689713`*^9}, {3.591542929763564*^9, 3.59154293633947*^9}, 
   3.5915429741991997`*^9, {3.591704687510915*^9, 3.591704697289447*^9}, {
   3.59170474157908*^9, 3.591704821817129*^9}, {3.59170486674509*^9, 
   3.591704888738887*^9}, 3.591705370444601*^9, 3.591705510131855*^9, {
   3.591707100395672*^9, 3.591707101264482*^9}, {3.592309798356081*^9, 
   3.5923097996986017`*^9}, {3.592411162495311*^9, 3.592411172665133*^9}, {
   3.592411886523912*^9, 3.592411910550042*^9}, 3.5928513344963713`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"metric1", "=", 
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"UnitStep", "[", 
      RowBox[{
       FractionBox["1", "2"], "-", "randmag1"}], "]"}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.591705170525907*^9, 3.591705177102399*^9}, {
   3.591705267927184*^9, 3.591705340880934*^9}, {3.591705372980096*^9, 
   3.591705386330261*^9}, 3.591705507660561*^9, {3.5924117339340773`*^9, 
   3.5924117444395123`*^9}, {3.592411931657456*^9, 3.5924119860554323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"metric2", "=", 
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"UnitStep", "[", 
      RowBox[{"randmag2", "-", 
       FractionBox[
        SqrtBox[
         RowBox[{"2", "-", 
          SqrtBox["2"]}]], "2"]}], "]"}], "*", 
     RowBox[{"UnitStep", "[", 
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{"2", "+", 
          SqrtBox["2"]}]], "2"], "-", "randmag2"}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.591705170525907*^9, 3.591705177102399*^9}, {
   3.591705267927184*^9, 3.591705340880934*^9}, {3.591705372980096*^9, 
   3.591705386330261*^9}, 3.591705507660561*^9, {3.5924117339340773`*^9, 
   3.5924117444395123`*^9}, 3.592411931657456*^9, {3.5924119639527397`*^9, 
   3.5924119930794983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"randphase", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "Sites", ",", "su2Runs"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.591704910975716*^9, 3.5917049719834414`*^9}, {
   3.592309786816736*^9, 3.592309788726398*^9}, {3.592412009000504*^9, 
   3.592412009127775*^9}, 3.5928513345154552`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"randrest", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}], "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", "Sites", "}"}], ",", 
     RowBox[{"{", "su2Runs", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5917060486467237`*^9, 3.591706124952127*^9}, {
   3.5917061659995937`*^9, 3.591706171782913*^9}, 3.5924117615688868`*^9, 
   3.5928513345341377`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"randupinit", "[", "n_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"randmag2", "[", 
       RowBox[{"[", "n", "]"}], "]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"randphase", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "n"}], "]"}], "]"}]}]]}], ",", 
     RowBox[{"randrest", "[", 
      RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randmiinit", "[", "n_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"randmag1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "n"}], "]"}], "]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"randphase", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "n"}], "]"}], "]"}]}]]}], ",", 
     RowBox[{
      RowBox[{"randmag1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "n"}], "]"}], "]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"randphase", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "n"}], "]"}], "]"}]}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randdoinit", "[", "n_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"randrest", "[", 
      RowBox[{"[", "n", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"randmag2", "[", 
       RowBox[{"[", "n", "]"}], "]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"randphase", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "n"}], "]"}], "]"}]}]]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.592309652735567*^9, 3.592309761753388*^9}, {
  3.592412085275374*^9, 3.592412189401498*^9}, {3.5924122364929323`*^9, 
  3.59241224049856*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"randinits", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"randupinit", "[", "1", "]"}], ",", 
      RowBox[{"randmiinit", "[", "2", "]"}], ",", 
      RowBox[{"randdoinit", "[", "3", "]"}], ",", 
      RowBox[{"randupinit", "[", "4", "]"}], ",", 
      RowBox[{"randmiinit", "[", "5", "]"}], ",", 
      RowBox[{"randdoinit", "[", "6", "]"}]}], "}"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.591706139611889*^9, 3.591706142825816*^9}, {
  3.591706182773778*^9, 3.591706358948798*^9}, {3.592309828486023*^9, 
  3.5923099036897306`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"randinits", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"randupinit", "[", "n", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"updownmiddle", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"randdoinit", "[", "n", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}], "~", "Join", 
    "~", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"randmiinit", "[", "n", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{"updownmiddle", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.591706139611889*^9, 3.591706142825816*^9}, {
  3.591706182773778*^9, 3.591706358948798*^9}, {3.592309828486023*^9, 
  3.5923099036897306`*^9}, {3.592847710432528*^9, 3.592847719457841*^9}, {
  3.592850719212137*^9, 3.592850901110921*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResNorm", "=", 
   RowBox[{
    SuperscriptBox["Norm2", 
     RowBox[{
      RowBox[{"updownmiddle", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"updownmiddle", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]], 
    SuperscriptBox["Norm1", 
     RowBox[{"2", 
      RowBox[{"updownmiddle", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.592412508373138*^9, 3.592412516670064*^9}, {
  3.5928518656564693`*^9, 3.592851905155135*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ProgressIndicator", "[", 
  RowBox[{
   RowBox[{"Dynamic", "[", "su2Runsdone", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "su2Runs"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.589818807091964*^9, 3.5898188646453953`*^9}, 
   3.592851334550692*^9, {3.592999201723188*^9, 3.5929992157056627`*^9}, {
   3.5929994038021383`*^9, 3.592999416766486*^9}}],

Cell[BoxData[
 ProgressIndicatorBox[Dynamic[$CellContext`su2Runsdone], {0, 1000}]], "Output",\

 CellChangeTimes->{3.592999313726159*^9, 3.592999354133684*^9, 
  3.592999423020605*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"spindyn", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "Nt", "}"}], ",", 
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "Sites", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "[", "spindyn", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"su2Runsdone", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "[", "su2Runsdone", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TWAres", "=", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"metric1", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "m", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"updownmiddle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"updownmiddle", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"updownmiddle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"updownmiddle", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{"updownmiddle", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "]"}], 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"metric2", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "1", ",", 
            RowBox[{
             RowBox[{"updownmiddle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"updownmiddle", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}], 
        RowBox[{"{", 
         RowBox[{"vs", ",", "vss"}], "}"}]}], "/.", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"eqnss", "~", "Join", "~", "initialss"}], ")"}], "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"U", "\[Rule]", "Uvalue"}], ",", 
             RowBox[{"\[Mu]", "\[Rule]", "\[Mu]value"}], ",", 
             RowBox[{"J", "\[Rule]", "Jvalue"}], ",", 
             RowBox[{"navg", "\[Rule]", "navgvalue"}]}], "}"}], "~", "Join", 
           "~", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["s", "0"], "[", 
                RowBox[{"m", ",", "n"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"svarsingreek", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Alpha]", "\[Rule]", 
                    RowBox[{"randinits", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "1", ",", "j"}], "]"}], "]"}]}], ",", 
                   RowBox[{"\[Beta]", "\[Rule]", 
                    RowBox[{"randinits", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "2", ",", "j"}], "]"}], "]"}]}]}], 
                  "}"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "1", ",", "Sites"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}]}], 
         ",", 
         RowBox[{"Flatten", "[", "vs", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spindyn", "+=", 
      RowBox[{"Table", "[", 
       RowBox[{"TWAres", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "ts"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"su2Runsdone", "++"}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "su2Runs"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avgspins2", "=", 
   RowBox[{"ResNorm", " ", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"spindyn", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "/", "su2Runs"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avgspins2", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"avgspins2", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", 
    FractionBox["1", "8"], "-", 
    SuperscriptBox[
     RowBox[{"avgspins2", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "2"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.574354116242147*^9, 3.574354119418839*^9}, {
   3.5743541632422132`*^9, 3.574354177906248*^9}, {3.574354216548272*^9, 
   3.574354261577943*^9}, {3.574354300342412*^9, 3.574354323599267*^9}, {
   3.574354360612348*^9, 3.574354360899602*^9}, 3.574354391312621*^9, 
   3.574354423769989*^9, {3.574354466761181*^9, 3.574354496919681*^9}, {
   3.574364147339254*^9, 3.5743641524573793`*^9}, {3.5743642653215017`*^9, 
   3.574364266279681*^9}, {3.5744187992515306`*^9, 3.574418843097842*^9}, 
   3.574418888201332*^9, {3.574419014960393*^9, 3.57441913723573*^9}, {
   3.574419451023178*^9, 3.5744194556536922`*^9}, {3.574420323711615*^9, 
   3.574420329007485*^9}, {3.574420438573976*^9, 3.5744204654709787`*^9}, {
   3.574420606351519*^9, 3.574420613823875*^9}, 3.574420860692884*^9, {
   3.574422189511854*^9, 3.574422197466587*^9}, 3.574422524199856*^9, 
   3.574422696864335*^9, {3.574508738413047*^9, 3.574508738491351*^9}, {
   3.574510414073822*^9, 3.574510415084268*^9}, {3.589632509982525*^9, 
   3.5896325101379347`*^9}, {3.589632544464816*^9, 3.589632574505185*^9}, 
   3.589632878025939*^9, {3.5896329429593*^9, 3.58963298118451*^9}, {
   3.589633049471304*^9, 3.5896331476999903`*^9}, 3.589633199340828*^9, {
   3.58963349242874*^9, 3.589633520722431*^9}, {3.5896489601309233`*^9, 
   3.58964902000793*^9}, {3.589649093878374*^9, 3.589649098947297*^9}, 
   3.589649166049993*^9, {3.589650059316646*^9, 3.589650069039631*^9}, {
   3.5896518170970993`*^9, 3.58965182501801*^9}, {3.589652678784327*^9, 
   3.5896526924307127`*^9}, {3.5896529165591793`*^9, 
   3.5896529281969147`*^9}, {3.5898113980846357`*^9, 3.589811422482305*^9}, {
   3.5898114756649313`*^9, 3.589811744969425*^9}, {3.5898119992841997`*^9, 
   3.589812021033285*^9}, {3.589812163221921*^9, 3.589812168965527*^9}, {
   3.589812269575645*^9, 3.5898123011107273`*^9}, {3.5898123976609583`*^9, 
   3.589812402235618*^9}, {3.5898130296185913`*^9, 3.5898130332205257`*^9}, {
   3.5898175742556057`*^9, 3.589817626716304*^9}, {3.5915455509713163`*^9, 
   3.591545575892694*^9}, {3.591545622982911*^9, 3.591545623273871*^9}, {
   3.591545855535365*^9, 3.591545858454315*^9}, {3.59154593363759*^9, 
   3.591545982279759*^9}, {3.5915460319341097`*^9, 3.591546040313684*^9}, {
   3.5915462025280943`*^9, 3.591546203546935*^9}, {3.591546245128715*^9, 
   3.5915462472264767`*^9}, {3.591546526954933*^9, 3.5915465541117773`*^9}, {
   3.591549959058434*^9, 3.591549984687414*^9}, {3.5915500181171293`*^9, 
   3.5915500913748217`*^9}, {3.59155012753371*^9, 3.5915501714458942`*^9}, {
   3.591550273500807*^9, 3.591550278432013*^9}, {3.59155032649546*^9, 
   3.591550392642951*^9}, {3.591550558762545*^9, 3.591550584462277*^9}, {
   3.591550617315886*^9, 3.5915506452920933`*^9}, {3.5915506777783957`*^9, 
   3.5915506888111877`*^9}, {3.591550900291531*^9, 3.591550904224525*^9}, 
   3.5915513005507927`*^9, {3.591551462187971*^9, 3.591551465835145*^9}, {
   3.591551581451537*^9, 3.591551585910713*^9}, {3.5915517701724358`*^9, 
   3.591551773266152*^9}, {3.5915518776850653`*^9, 3.591551886551238*^9}, {
   3.5915536870403967`*^9, 3.5915536936689367`*^9}, {3.591642939109455*^9, 
   3.5916429464307756`*^9}, {3.591654414448934*^9, 3.591654481729301*^9}, {
   3.591654647905533*^9, 3.59165467879396*^9}, {3.5916560050830517`*^9, 
   3.5916560769743023`*^9}, {3.5916561688653316`*^9, 3.591656215852907*^9}, {
   3.591701004049199*^9, 3.5917010042794437`*^9}, {3.591705897601893*^9, 
   3.591705917781198*^9}, {3.5917064081405888`*^9, 3.591706465179832*^9}, 
   3.591706612843011*^9, {3.59170683054733*^9, 3.591706889785873*^9}, {
   3.59231434439212*^9, 3.592314389009316*^9}, {3.59241234160008*^9, 
   3.592412386672886*^9}, {3.592412425511486*^9, 3.592412460114133*^9}, {
   3.592412520784307*^9, 3.592412523998085*^9}, {3.592412562481407*^9, 
   3.5924127067586727`*^9}, {3.592847789105229*^9, 3.592847794291308*^9}, {
   3.592850926162711*^9, 3.592850933883211*^9}, {3.592850981854041*^9, 
   3.59285101236136*^9}, {3.592851158143547*^9, 3.592851159276093*^9}, {
   3.5928513345722446`*^9, 3.592851334604307*^9}, {3.592863669458356*^9, 
   3.5928636716423273`*^9}, {3.592919916952195*^9, 3.592919926659651*^9}, {
   3.5929202402581053`*^9, 3.592920241897933*^9}, {3.5929203320119333`*^9, 
   3.5929203349567327`*^9}, {3.592920388415098*^9, 3.592920414250957*^9}, {
   3.592920453459929*^9, 3.592920481698493*^9}, {3.592920529777388*^9, 
   3.592920587533828*^9}, {3.592998608250331*^9, 3.592998655958479*^9}, {
   3.592998693072153*^9, 3.592998782280861*^9}, {3.592998825997513*^9, 
   3.592998828711877*^9}, {3.592999384393107*^9, 3.592999398170374*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "15.42259600000000041575276554794982075691`7.208757395527818", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.592920351011138*^9, 3.592920423258897*^9, 
  3.5929993199328947`*^9, 3.5929993810713787`*^9, 3.592999472319296*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Save", "[", 
   RowBox[{"su2outfile", ",", "avgspins2"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.592419475875058*^9, 3.592419503555793*^9}, {
   3.5924224220417624`*^9, 3.592422428843439*^9}, {3.59284745558225*^9, 
   3.5928474644584017`*^9}, {3.5928480782229643`*^9, 3.592848127128303*^9}, 
   3.5928636627850847`*^9, {3.592999165605782*^9, 3.592999176962594*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"times", ",", 
        RowBox[{"avgspins2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1", ",", "n", ",", "3"}], "]"}], "]"}]}], 
       "}"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5915519938375998`*^9, 3.5915519966023903`*^9}, {
   3.5915520335706863`*^9, 3.5915520653129673`*^9}, {3.5915522339790916`*^9, 
   3.59155224684162*^9}, {3.591552385174741*^9, 3.591552398238976*^9}, {
   3.591648023389412*^9, 3.591648037593389*^9}, {3.591648455143827*^9, 
   3.591648455261454*^9}, {3.591706743509222*^9, 3.591706760384873*^9}, {
   3.592310170441049*^9, 3.592310231941976*^9}, {3.5923105362206717`*^9, 
   3.5923105744816227`*^9}, {3.5923108290296803`*^9, 
   3.5923108561466846`*^9}, {3.59231133154348*^9, 3.592311350543209*^9}, {
   3.5923116947225533`*^9, 3.5923117371477823`*^9}, {3.592314990894663*^9, 
   3.5923149912343273`*^9}, 3.592315028998342*^9, {3.5924133632155943`*^9, 
   3.592413363380072*^9}, {3.592413444207828*^9, 3.59241345774254*^9}, {
   3.592413491474895*^9, 3.592413494117703*^9}, {3.592413886033042*^9, 
   3.5924139008540363`*^9}, {3.592847867974071*^9, 3.592847868074987*^9}, {
   3.592918465717051*^9, 3.592918489436728*^9}, {3.592920496557394*^9, 
   3.5929204966275263`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.24720000000000014`, 0.24, 0.6], LineBox[CompressedData["
1:eJw9lQlMk3cYxpEhXjgdRQWGgFgWYYgoV2ECDw6QcraUUo6CpQc0bh4Y5XBN
EAYEnYhuaHSAB6AhE7RDdIqKdBsLoDhPQAXURReMylEq4BQ2lv3fNfnS/PL9
j/d93ud9v2XyLTEqYyMjo13Tz7//9NOs58nnLx8N+I/eBhRqXMZrbIjnoHF5
kvVNJ8Yt5qgrFPs/X0nvrZA0GPVW4cIYdni3TfzSg0vrHVAq3LRjeBnjJ45o
tfy1YWQp7XfC+5KiohkfM7Z3gevYuooiUzpvFc61yv1zjRi7rYZbZwy/2pLO
X4Nljkr7TfaMBR6oX+U7r9OM7vNEf8KUFYfDeKs3kuv8VVxzut8H13ussy7R
fft9kdw23LvHiuJZi6GznIELnzLW+kEyu9n0DemBACSURhWaLmGsBpy/iQ5+
bUHxBuK6uPvKVYp3IhBl1hOqZjq/ZR1ad1Sc0H7CuPhzNA+a47wD5ROEXSce
u+sdGVsG432h6OVST8ovGGpnRVs81a82BD3HD516t4ryXQ9rH15zLtWDF4ok
xz7HL4iN+CgNatj1N93Xxgcn+75n82rSIwzCW6bLEzwYx4fDJnP/V9kgfSLQ
sjlrj1k044EITHxQsW9hIOkViRcH9v500Y9xdhSiyzU18b6kXzS6w0Nsq+l+
EwFsnr65pXMnPQXo01fq3CieGwJcMLgN7XElfYU42+himCL9yoSwPPp17fbF
pLcQ4pMxdmc+ZCyNweyOO57ji0j/GJzqHUl9Sv7gimDWpg6ZS/4pFuFGWsP2
zhmMX4ngMZnx15P3elafWKy46B3j95ZxYyystMdiyyYYW4rRZ3PwWzvarxFD
53DaaOYCqp8Y1t2DLiqKNygOriHeOXXUL7Vx2FgTbggl/5lJUL5RO/qK+mWr
BBn+Jl9up3zuSSAJTBRoaT8vHk4CztMO8k9FPHxadNzK//s9ASUH5gxcIv2U
CQhYMnP9NvJHWwJm/F65MG8FY5dE5O14LX3gTP5IRMaanzXv3BgbEmH2jKd6
4UV+ScKx5B9Gf+QzvpKEgjuavX0R5B8p9IF3e9fR+gIpRJmhwQV03oAUwzUr
k3Oo/hHJcD1bf7Wb6q9Nhn3AvMvtFI9FCv5YMrb5M8ovOwVzHCoP9tO86U2B
QB2qu0v9iA2oKcnJPEr9WrMBs45vaZ+g+WAig/9iL4mO9PaS4Vl/cM+p2eRP
Ga6F1sdFTbF6fy+Dk7qwXk3vb8jg2xWr6aX5MiVD0+YRXimtd0tF82RV7Plx
xvJUxMuyjB8Rl6Xi1TFlRSD557dUNBh3cyLmkr9TkVJuNXWf/OQsx6A3/1AR
5SuVoy4x16uJ9Nknh8FcKX9A9W6RY3x80KedWC/HPMmFh0nU71wFTvvKvnu9
lnGcAhZXbAcWU/8WKzAYdrnDaQ3jJgVODBW05/KoXxSYPBL2YNKbsa0S1mND
+mryk0CJldyqjpOkb74SGY8NRdEUf6MSYSY2xhzyw59KZPFy+2wpPksV3Idf
zmqleRymws1wRHvYUb+pID2Q436Y8jsz/b5r5/kjdN4TFUTcznwNnWeehnvZ
u32e03wNSkOUzi9yEa3PTEOKMEcVQt+72jScqxZYjFF/PUxDXtSdheWUj1n6
9PrQsUjyk386fkmpyj/yEfVvOnqECk46fT+q0mH6SJTfQ/PlXjpybt/OWzDK
2FQ9XQ8nfr+eMU8N/qggkmtgvFGNkvuKa100jyrUmN+k3eJB+2+qsZN3uOv2
iD7gH4/Dg2E=
      "]]}, 
    {RGBColor[0.6, 0.24, 0.4428931686004542], LineBox[CompressedData["
1:eJw9lQtUjGkYx1uXhHHJumS1KrmlsZqsVNvlnxlbKKb7bUZzn0Qjl5JbiiKb
TFYX5RZLpYtmVy2ppVNORWFR1LJUjjZxRNtqbLtr7fE++50z5zu/877f+z7P
//k/z1jI1vsohxgYGMR/+P33pqfrkaMqVvHq6kd655oSt+ZKlYp4JLiGjZyQ
OMbVEyAfrJ78u5bWp6JE7psZc4oxzGAhHux2KaH9MzB8wJmfcIZx+yxc2ltz
u/UwfW8Fv8fGupZsxuZcSApNIvjH6bwFsDMJqtpygLEND6bFzZKScjrfFif1
famTCxgLv4QugeeQkUX3LYJth6BsXz7jqMVIsnCr5dN+AwfUT5qxbWYO4zRH
8B/HzvUsonic4GTANfam+3TO+IZfM2JnNcXnioC9D1PHnGUcDkjvDGT/H5+N
GzZq153qu8BY7wbnQ9rXTrUU/xJUbl1Tr21knMzHwpmpfN41ykeAhIGr7XH1
jE2WIvHTSZXb2ii/pTCae7Z9C+VT8DXmXHxiOLWY8nWHdoXjvOekh70HrDi9
oWdPUv7LYDgt8VEp1bNhGc65W8aNp3qkLcdgiYX1V7QetAL9m28vr6fzzD0x
umOiR2ku425PPB2ta1DtJr284A+z1MpExrErUflG0xmVQvqtgusNZb5lDONh
Qox3rHgfm0l6ClG+4+j1lUcZNwkx9HBK7osM0tcbuT0FinSqX7o3pBvj/moj
PfTeqBhiqLxP6yIf3Bn7LD6Z/FjtAx9RQeWcc4xn+iJv+A+aez9SPXyxakHO
rfJDjF/6otjDusAqnurjh6PPAjOFpE+ZH1rdX9/Xkr9N/OFu5d3VcoTxDn94
2I497a+j+vlDUFcXZnOZsSAALvoL+iXfUz0DkBO/4Ykz+YUTiHPaw3tWkT+i
ArFf3GJdRvubA2FVs2jPTuof+yB0Ctca551gfCwIJ4LhHkfxGARjPu9h9cRC
xopgjCnKGj6N9GgIRtWzEaYudD83BCIbg2tX75E/QhBxcWnZ0/eM+0PwkyDR
6z1xUCheNk6u/XNk70euCkXqMnFCmhFjcxE2f97bp+th+xNFqA/elvsFnd8t
Ai++TWZK+XqKsUk7241D/tOJ8dvb/qdTNjOeuBpXvA5yb2wgv62GV+y6u83k
r0erkemUNHbUdvJfGA4k7f9ZHcn4TBjyGy/3KWXkRwl4mpGzb+5ibCfBIG9S
BTed/ClB01DNbVvSM0cCO/29TkvqvyYJurjivBbqj38kKL1jV/eW/G0jxWBp
t2Ua9YdMiudu6yM1GvKzFOIObWV0KOM6KcyE0Q0T/MjfUoSWJ2x3XMF4ngx3
s/I3BNK6SIbP2h7cmqJmfFAGo1bT1r4o8r8MEfImU/Nwxn0yJL6w9h61kfpB
jj+GDKs9lMw4QI7XWdM73+2n/pCD4z1LUriH8WU5fIpEKQKa1y/lWNRmciWb
/DddgWkxZeMXUn8IFTit7C3aRXruVuCx5gX+pnlapsCmN/PP1Jxn3KXAg5oj
Tv00v0yU4NVHFxWQX5crUTsjJfkTmvc7lLCIM2y+Sf9P55XgmHVsVdJ8a1ei
Z9N3ecVVjCeoMGffSeN08rtAhW8rLpmOI7/FqNBr3/x2SwL1pwr6lFdrk8hf
v6ggX1tWOJ/qyVEjKFuxXUDzykWN6+NKen4lfaLUuG90POM4+eO0GrPleaNV
FF+zGg5hF3sy6HvDcJQ3enHc6H77cFwIs4r2p3pEhGNds8JZSPPpWDgiD5YO
LKb5dSscmkhFh8MH/f4FAf3nKg==
      "]]}, 
    {RGBColor[0.6, 0.5470136627990908, 0.24], LineBox[CompressedData["
1:eJw1lQtUDGgUx9stLRV2k1SLrbC7xDZ6DZbtjxSaapoe0/SYmaZpGnlNw1JK
zyG1lWFb9MAc69GSJBLSY5Nk25P12mxqtSRFcVJZNo+1+11zzpw5v3O/7373
8b93bGRrBZEf6unpJb/7/vf7/nMpLi9uyhGuK6OXruor0eWmRjLiUdC+9Vjn
fFTMuNYUiR63zrfVKMluCQNrl1kDBzYwxmfYbylcMD4klc7b4uHSMXVdXimM
O6bB1GHv2kD3RLo/HRe7VkTHWdF565kY+K17dJhjNvmzx6nUtmxrgyzGnNlI
rXvtpHHNJP8O4HV3DtwfpPt8J9zuSQnKO7iN3nOGxUm3Sk5iBmMVF+rNdq05
U+m+3ly8lQgOOgrIv3YebM+Y+KxyTKd45uPIqvBHun3JjEsXwHZEw7ztyzUU
nyuuOd+I7X+wlbESeDlOmZRr9T7ehRjlVbYn/yK9/2Ih/AUfX/tjPOVXuwjT
O0LLY05SvNsWY9OwUVpKCzHfDVdjFD1rTIgtlqDKobI+Y4je71gC68lPdPLd
VN8id3jIj9slhsZSvh7o9ZNwY2vjGM9ZimrpjVXTT22m/JfBTvv1vTFTNzJu
XAZd9fxJAXbRVI/lCFn0IMYHgYyDPLHukkfZ4WWLalh9eJByJzhnXlcy7ubB
rcz8/idTVjIu9YJowRv//ZNljGO9sVOV+MP2g3QfPnC8NSHx+PpI5t+Aj4qx
YWpdVgTVkw/jzxMMMjSrGf/Kh+2fOc0Gq4k5voh1d9x0dxflm+uLtlbD9GEb
qtcLXxQHRS0M1hCHCvDBCIuXATzqb60APWay/DFJ1J+pfjAKOaatj9ZSP/zQ
WLPjeUYx9bPXDzmdJvFVNaQfvj+GfI7tODyLzp/2x+J954ya7xJbBGCGw9Cz
5KYcxgkBmJzg1HL2LPW/IwC6oKQpgiTy7xaIaM/ceQId9bcoEMaulyXNfGIT
ITg9D8u5i+m8SghxXEzhodsUz00haoNMvzcNTqJ+ByHhyS+DjTfiGRcGYaPz
XY6ubxP1X4TsW/PvmHiTvuUizFXvyVrjSHpqFMEEnqFXT29hPDMY8T9mOoz7
ieqpDUbf3w3FSXzKdzAYW+Nur+4vpfyCQqDdXJWX3kTzcSEExuts62bcoXys
Q1F5SjK8r5T8aUIxlJc7JfAEvdcdiqzOhsZ5KoqHF4YGoblq5CD1vzQMQ+ZP
rTTtcxibiWGoMcyxvSVhHCtGi9KypadkLeM2MU7sLuI9fPV+X0kQUX9k0rjw
9YwPShAfNQfXtqhIj1LM1IyzaVfReRcpNop3Ne1sJ70opUjsM9pdPILyz5fi
vltagfqf7aRXKToVluaveqkeb6QQilyqHxSQnRMO89VdvvZrSR+ycPjoRFce
3aB65IaDE3ax/F497cuGcBTrWZzpH6kmfYejpCti4OdpUsYzZLhfsMu+boDD
5itUhm6rJ/oVmX6Mc97ZrcO6hGE+pH8ZPuQ9ys2Wfcrsz2TIFLYX2JjTvE6N
wK6dVvaL5CLGgRGoe/744XG1O+NtETAX6O+NVrkyf+cjcHOv5AvNvf7q/7k3
AufWZH7p7UzzPFmOssyKCy4L19H8yNFRqOf/u5r0lyrHUc9DK8Jep9E8yWEx
NsqrP4/2V5ccZjZc13qvVTRfkeAZKGyeBtM+Wx6JSss2O2Me3U+IxHI/6zZh
fgLjkkgcPhao9b1C9zsiUYKRLTHTyG6qAFdUtUfFoXq7KfCKM/FeffxKxhsU
6Ct9btJuEELzqcDsLL9O43D6f2xVQNEsao28TPvIJAqOwy7iQR/S8zdRGPrL
Sz9TS/GpolCx57q4OI/sB6Iw2lPtlJFBeroZhb6vzLiXUnYyNlQi/duPcjfq
k32OEo+bvjuUdpo4WokiXRo/2Zv2Q6ESDgMScVPvDsbNSqi4E++UjMh1/Rd1
I2Up
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0., 0.},
  Method->{},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{
  3.592918490443943*^9, 3.59292006558855*^9, 3.5929201455952063`*^9, 
   3.5929203522830963`*^9, {3.592920488832595*^9, 3.59292049695019*^9}, 
   3.592999320710847*^9, 3.592999475468009*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"times", ",", 
        SuperscriptBox[
         RowBox[{"avgspins2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "n", ",", "3"}], "]"}], "]"}], 
         "2"]}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5915519938375998`*^9, 3.5915519966023903`*^9}, {
   3.5915520335706863`*^9, 3.5915520653129673`*^9}, {3.5915522339790916`*^9, 
   3.59155224684162*^9}, {3.591552385174741*^9, 3.591552398238976*^9}, {
   3.591648023389412*^9, 3.591648037593389*^9}, {3.591648455143827*^9, 
   3.591648455261454*^9}, {3.591706743509222*^9, 3.591706760384873*^9}, {
   3.592310170441049*^9, 3.592310231941976*^9}, {3.5923105362206717`*^9, 
   3.5923105744816227`*^9}, {3.5923108290296803`*^9, 
   3.5923108561466846`*^9}, {3.59231133154348*^9, 3.592311350543209*^9}, {
   3.5923116947225533`*^9, 3.5923117371477823`*^9}, {3.592314990894663*^9, 
   3.5923149912343273`*^9}, 3.592315028998342*^9, {3.5924133632155943`*^9, 
   3.592413363380072*^9}, {3.592413444207828*^9, 3.59241345774254*^9}, {
   3.592413491474895*^9, 3.592413494117703*^9}, {3.592413886033042*^9, 
   3.5924139008540363`*^9}, {3.592847867974071*^9, 3.592847868074987*^9}, {
   3.592918465717051*^9, 3.592918489436728*^9}, {3.592920496557394*^9, 
   3.5929205190395737`*^9}, {3.592920593776338*^9, 3.592920593971403*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.24720000000000014`, 0.24, 0.6], LineBox[CompressedData["
1:eJw1lQk41HkYx4cO64lHSSm51pOnZ+mwKzXk+BbKbYzc1xjGzOoRmyMmStpK
oZAjR6u1WnQwdkmhxyiPRxfbYR9HJLUig60lOdrr8f7neeaZ5/O87+/7nr/f
fMmP5ArkWSxW8n/f/3+Zj57WC88exSKrRZq1atZrXeP5mmFFDNf5mHQPFi+y
VBV2PXcbs8IvkX09Yj2m2emKxNDBATmRl7SK8dfDrLjE4U4W6Q3qw++a5TVX
biGd/wpyYouolUbEupvRcrxvR75nPultQ9eoPG+LY94iG32NOtHQqUyPAtL/
BqIrtQpLWok527G02z2XtecixTPB1mXbXimeIo7aCbs7NzQmGTvLFOLS6OqZ
ZOJMMyRNdXit6GXyMUd0RHi2pJDqk1hg5cOirAvmTL1WEI/Ea41KqT4REJTI
PafsSPUb7YZP+S3W6kjiT7tRdZbt33efzkv3QLXO5rLv5h8WOdUa9TKFfBcH
snNsENBfM/HYn+zrbGFt7meWIS2h+mwx0Xh15hcrslfshVxTmdncbYoXtQ9S
p1A3hTzKj20HsfKHP67/zvTfHqI3R5QMTMm/3R4DaeMDV1IpfqYDOMNem7YP
kN3bEWqjax07JyierhP2qlm3btC8vMgjTuAfjn45KCC7xBkyB2vLcWPSi3eB
RlvNyRon0oMrKqXT18bLKZ+lHJzNivAQdpJdxAE70fivchuq9xEHJ57f7F1Q
In0jN+wz+8TjxBPnuCE2Urp1IYDptxusnNn3MnNoP/y5sCu+0NPlS/GkXLjN
bl1zY5DsG91x8lxXXtJ12r9Ud6zSbF2iHZW7yDJ3eKv3PxTfyqH57MdI36vx
OFn2ItfuxxkLnVQPpQs0Lw+8VbKYTvqT/BM9IE73fZ3XQXqDHgjXU3G0fUDx
bDzRIYkpCJWn/Co8MdvWOSOsIFbyQlNxZeu7Eso3ygtcrfpqSwuyP/dCxdPG
u7VTzLy9cWZP2qGkdupHsTc+G6kMeR5k7q8P1NIr595MEof64Lu2lsDs89Tv
dh987J3TkiUQb/aFX9suQbErsx++WCH9dfb7DcRTvtiSoTBZbUDz8PZD9JH7
jgnOtB9NfjgQ0/egr5P0dP3hNHSxuzSf/L/3x7zwyQp1Zcp3xB9j3LKjL9Wo
PqcAvGdlBasUUf2SAJzWH+p31yRWC0RPWrdGmjpxfCCGBqqG0uLofr8IhDlS
YBhPjCDkaRsflrgRlwVhDlraXwwQL+WhvTJiQvtb0tvBwxPVQPl9FTQvEQ+O
eduVsgeIC3k4pDLi0xBA/o94WNehK633Jb2/eZAtb7IPP0H+RsGI6OpeXxJL
7xs/GDHpswWtzbQfOcG4F5QhuKRP/m3BcOV3JVjlkv6nYPzYYKKtGEdswEcz
qyUsMpX65c9HqWx/3Zg97cM5Pgx3eUuihcz+81HkPj8dHUv9/sDHlEOF6UQU
zWNjCHo53MS9/cSeITj+W/IqRUPmvQoB5PoftWUQN4TgUPpR7jvmvspC8Fhy
OebpabJrh+JkSmTW3EGKxwlF65Jq42QXyj8lFMtT0+rFj4lrQ5F+KXfAYhf5
D4fCK/mtwI7Jd50Ak5ts9BWY99dBALPRtB4dR6ovUQDZwgnv0w+IqwTwXiN0
cO5g/o8EGLYOm09YTnqqYWALqyttm8nfJgx58zPLjJn7FRcG1seCZ//Y0vmK
MKQq32b//Jny7Q3DMcN21xemxEpCLFt7taWzhthSCJuyRPVt5cz9FUJz9bH4
RAPSLxXivfj82Z0c2pfnQrSyUxp1fqJ9WC5CQe9CyZgGMVuElc/CGlS0aT/C
RejbyTPv8SIuFsFS6abLWBztV4cI2gEmPnOFeVb/Atx4d/E=
      "]]}, 
    {RGBColor[0.6, 0.24, 0.4428931686004542], LineBox[CompressedData["
1:eJw1lQs41XcYx2kqlfE4WlmJWGYuuRQhyfe4FQ457hyXc+E4yHIqRqu5TFJ5
JBrdJrdkPYUHi4me02VuoVo1lCI9C2llDdGkbc//5XnO4/k873ve2/d9f0db
uMsrYoGcnFzKf5///8//FX4Re58XFWDH0IzdVvbDvrGjvsRLYO4n8shncxmW
sZBRsbR9dMCD7J9jcs+bz1YEbGMYWljTeOdjaokt+evAdGYqmTPhyPCgLvq4
5ZPSOIonp4+oNY9XXC53Y3itEfoskKLJdaJ4Jqhz26iTfdeeYVMzHGpamDer
wqH4GyCvM+xaZ+vJsKc5BiYSx8e6dlA+C2j8mMq7YenNcJwlypLu/5PV70f5
rZFWm2UzUxTCcM5mNDSebOkcoXms3YKSndrS3Ks0j2pb7FudHdTxuz/VZwef
QoODGmo8hiXA5WsmegUCimfKBq8gNOVIJ/lPs6Fs/e1tjy+pHpk9pIEm50uz
qP5MB7Roh072BtN8PR1hHdDcYiGj+ak7Ifn6lmV5Hc7UnxMKf51a5yV1YbjC
GdVOsuIGIc0nbhvee46I79kRW20H2/djyJT1/PxdMOreINUbIm5zgdZ3VqcX
pdP8clxxqOvUhCxxO8MBbjDc3WbZvHleLw5MTiwbff7aleERDlZLuJMq16ie
aneEtNfmOoP2I9ED59h8Kesg2bEDe/ojFfNayK7gifiwsQUmmaS/xBOiFA3f
m7tI/05PbPqtzMdwoQPNlwvzBQrm0gbyP8HFxyV6YrMs6meai0+cdwa9nSUO
9sLPSTpKL1jUn8wLsWm8qmJbL4bXeYP3lfXiuknSJ9Mbxn9UDsuvJP1feWP1
cFfuMz0f0scH9l9PqardJv86H5yv619haEjx1H3Rn7dv+60amv9+X7DjbcaL
GqneQV+wrmtE96RTf45+SC65p2n0N+lb4Yf0C0uNKjpIfyV/6HZ0yNdWzevr
D1WLl8sGOyj/A38kN7gfSE2j+qwCcO5An7Hb0UCGzwbghEPB4K6Q+XsPhP6Z
JwM15dRfeCBGot++dFQlfdsCkb/U0W8ygeoxCoKh//HMpnQr2o8gPIqZacyu
NGB4Iggd00nd9SlatC88JJUam8l7rWK4iYc0o+Eq1VlN2p9g2O+OqR46Y8Zw
ejAGemw5ex0saZ+CcTdjY0xJKZthTgii7URuQ0voXqpDMDex9klQGs17eSjm
Otnx1TbEiaGob5UvHrCk/vpDEf/UyPuFPjHC8KFQa32YF82jLAyNP71pVV5M
74MCH/29vOt/pdM8N/GxLf5g814n+r6Ej77Zy37Wx8h+mo9TSqEDh8Ipfycf
MonyPXUz2r85Pgq0Nh2OvET+pgJced/TfnGY8gsFqM+4+6liaTDtswCxLuy8
MoQy3CLAE059u2Mdn/ZbgJCpgIfZNcQGQlQ2jW+5soE4WIiUWoMioS3pny1E
8hxXzT1m/v0R4mLr02PK6tTvWyHY5qyk7nfudA8ixE8Z27WM0X37iaB0RJQr
/wPdT6YINeuKjxffIv9GEULqvu+1l5H/KxFs2pM8FBXp3jXD8Xg3d0Y/f/69
Dge7W/nDSmuKlxYO76KhZxm9ZK8LR5xmzqqqetr3F+GI2imvs7eV4qtHwP7I
KL/cifK7RkBzuE3uZCft7/4IOK2UJoS5Uv7KCKTEGChsFhAPRmDRgzvvnvfQ
e8ISozJVMXRuev4exfhOL65Wqk3+CWIILjm0/ZJPelaIsVyuZOJRLO3DIzHa
L9SzLJpJT6VIuN5kjbdfJb23RqIkg381h0/7EReJGzpdd8afkn9JJA6onVEI
1w2ie46EXEQP3/xPsi+SYHGJyut+Dv3eWEmw3qu8+4MK6R0tgb51wv1vRonP
SiA+HK8r6xUw3C3B/tO2HZFRgXb/Ah0mUSI=
      "]]}, 
    {RGBColor[0.6, 0.5470136627990908, 0.24], LineBox[CompressedData["
1:eJw1lAtUzGkYxhNyyWa6adSKJCsq1XYVO89UpDYz1ZQuqmmmuZVLs933dGMQ
ki7klpA2Sq02q7MK0aJN7a4VRWgJJ5UN6bKbRdae3v+cM2fO7zzv93zv917G
RBzjJ1VXU1Pb/On7/y/z6VNVtrD52zjj9Jbz1Kv/UZvFduJpyA2aN6h9gvQG
HSzvuvxSnrmV9NkwMp5pp3+EGHNRe99fa04cnW+YD9MERVzgdOIuM6w4Ebzx
+C7G3xxNBxJKzk7bMc7zLHCusrZveykxloIffaM67SDFW9uAxxpQFPgy+dji
7jt2B+uxapx97NASZ+XqZreZ7rOH94cDHmVP08dZ6QiBuEIu6SZWc8Ymf6E8
lps2znnLoLtAt3pobirlsxwtvRWtez1Ir16BpPy6idxc8gcHls0tAVsXZoyz
AiiOayocmE66NRfqr1df1RYRj3LRcErP6/T2LZS/K7Ja5l/haVL+O93gndgz
efks5j3uaGMnWSe5EbNX4udbx3a8fE317lqJoyyH5rJ7xOWr0NhT/5C3j+KV
HrgXOGW/eDGx02pUPNkTz+mi+9U88eVGnt9CK+IbnhjrZGkM3KZ887ywr0NS
zzYgDvoarDW5VR+cKX6eN/gmLQ/X88i/1xsNNlrfcj4jrl6DN8qrA7Ei4mQe
Mox/evSGS/0DHyXxTS96QP2d5IOCC6qTRcHECh/ULfUbNWTm5Tcf8C+e/v1s
bSbV1xfPVh/KSU8ivcAX7JrU4aZA8h/1hdjrYqLFINUn1A+O9nekmu+JG/yg
45xiYFVM+S0QYP2T2/eqnZl+COBrnlSqo0nv7RcgeV1YU80Q1cPHHwUjhWXa
X5Be449A43zZH1zS2QHgpP9bqe9GnBoAI/05GzCB/LsCEL1rX4rDj8Tua6GK
DM/a84r8ytdCt+LyhPUmpM8IhK7ZXukxJfkpA3Huh8KEIOa+tkA4Sc0WHVER
OwUh43NzfqSA/IqCEOs7ZNnTyPQ/GPbxfYe/1yZ/STDGdLXOX1xC9bkRDH+d
eFOPPGKLELxrFjp9PEPxeSE4cc2+UniS/IZDUFNR/rzIhPYhaB1aOfMbzi9K
GedL67BpKPeZTTazX6G4bpdTY11H+7gtFPV1cTP/TCTuDUXFsFPnIy7Fe4fB
lvWXtFHG7GMYrAcNb7UfpvfqhcOiI614oQHlmxyOtO/a2m3LKd/OcIxoHm/N
9yCGEKLzvZZ/uxKXCjG8O/fa8zE6PykCYTd3F0/eTPPlEIHDrzild21ovhQR
+HW/qcghm+ILI1CSxS+OUTLzGgGtPSKW4RSa17EIOHYcnKK+gvk/E0HtH58H
9k/JTyzCcZctjYJ64gIR3uv7CR5rUPwvIlSFCrPDZhGPinC7fmDIMJ3iF4sx
8kI7ylOTOFSMs1yT6UeZec8RQ+podEqNua9BjPbhLLvTQvIbFKMsaBn/Wj/p
CyJRqztbFb6I9LWRcJn91umbu+S3MxIxr5L7npwivhCJ3h2zTup1E/dHwssl
J8xPnfyMJRgxSmme1ELz4iPBY0dna0EosUqCXVF6BzU8mH2S4PXU7ij+EZqn
5xKw1fulrQmks6WwTGI/WJJJ7CVFfw5H1i1m9k2KIE9TByWzH1Wf9GhHT9cO
mq8uKfIMrFOvFNE86cgQpZ05N34isbsMQy+8YkMm0PlEGSqirM5oHWL2UwbJ
MiOWuYDm54EMae5KydBV0mfIobPf9tDEbNK/kiOCl74ml0X1UMqhxbt+qZrh
EjliXMy7fQVUvzY54lXtnjev03kNBaruTH3fxvTDSYGUpat2mwtpvqIV6Nww
ZjON6W+RAh8/rsoYzSe/mwoUq8w23f+Uz38ipVjd
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0., 0.00010040409351453989`},
  Method->{},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.592920594278418*^9, 3.5929993207720957`*^9, 
  3.592999478709734*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{895, 863},
WindowMargins->{{Automatic, 406}, {Automatic, 14}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 92, 1, 80, "Section"],
Cell[517, 18, 205, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[747, 25, 258, 5, 28, "Input"],
Cell[1008, 32, 807, 19, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1852, 56, 307, 6, 28, "Input"],
Cell[2162, 64, 807, 19, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3006, 88, 307, 6, 28, "Input"],
Cell[3316, 96, 807, 19, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4160, 120, 307, 6, 28, "Input"],
Cell[4470, 128, 807, 19, 63, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[5326, 153, 94, 1, 50, "Section"],
Cell[5423, 156, 239, 7, 28, "Input"],
Cell[5665, 165, 260, 7, 28, "Input"],
Cell[5928, 174, 441, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[6394, 184, 150, 3, 28, "Input"],
Cell[6547, 189, 120, 2, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6716, 197, 155, 2, 80, "Section"],
Cell[6874, 201, 3196, 90, 97, "Input"],
Cell[10073, 293, 4024, 110, 240, "Input"],
Cell[14100, 405, 5454, 160, 189, "Input"],
Cell[CellGroupData[{
Cell[19579, 569, 1256, 31, 28, "Input"],
Cell[20838, 602, 3350, 103, 70, "Output"]
}, Open  ]],
Cell[24203, 708, 2598, 57, 114, "Input"],
Cell[CellGroupData[{
Cell[26826, 769, 306, 5, 28, "Input"],
Cell[27135, 776, 11146, 324, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[38330, 1106, 177, 2, 50, "Section"],
Cell[38510, 1110, 1322, 34, 86, "Input"],
Cell[39835, 1146, 294, 8, 59, "Input"],
Cell[40132, 1156, 796, 27, 57, "Input"],
Cell[40931, 1185, 940, 24, 42, "Input"],
Cell[41874, 1211, 994, 26, 42, "Input"],
Cell[42871, 1239, 943, 17, 28, "Input"],
Cell[43817, 1258, 934, 16, 28, "Input"],
Cell[44754, 1276, 507, 12, 48, "Input"],
Cell[45264, 1290, 780, 22, 59, "Input"],
Cell[46047, 1314, 486, 13, 28, "Input"],
Cell[46536, 1329, 739, 19, 63, "Input"],
Cell[47278, 1350, 1943, 58, 79, "Input"],
Cell[49224, 1410, 607, 15, 46, "Input"],
Cell[49834, 1427, 1729, 46, 80, "Input"],
Cell[51566, 1475, 529, 15, 33, "Input"],
Cell[CellGroupData[{
Cell[52120, 1494, 387, 8, 28, "Input"],
Cell[52510, 1504, 184, 4, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52731, 1513, 9861, 200, 424, "Input"],
Cell[62595, 1715, 278, 6, 28, "Output"]
}, Open  ]],
Cell[62888, 1724, 414, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[63327, 1735, 1562, 30, 30, "Input"],
Cell[64892, 1767, 6225, 110, 228, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71154, 1882, 1643, 31, 35, "Input"],
Cell[72800, 1915, 6267, 109, 265, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

